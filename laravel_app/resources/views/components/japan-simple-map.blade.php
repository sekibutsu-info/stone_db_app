  <div style="max-width:800px;">
    <div id="pref_msg"
         style="position:relative;top:100px;left:100px;height:0px"
         class="text-2xl" >
    </div>

    <svg viewBox="0 0 180 140" class="Japan_simple_map">
      <g class="Pref Pref_01" id="1">
        <rect X="160" Y="0" width="20" height="20" />
      </g>
      <g class="Pref Pref_02" id="2">
        <rect X="160" Y="30" width="20" height="10" />
      </g>
      <g class="Pref Pref_03" id="3">
        <rect X="170" Y="40" width="10" height="10" />
      </g>
      <g class="Pref Pref_04" id="4">
        <rect X="170" Y="50" width="10" height="10" />
      </g>
      <g class="Pref Pref_05" id="5">
        <rect X="160" Y="40" width="10" height="10" />
      </g>
      <g class="Pref Pref_06" id="6">
        <rect X="160" Y="50" width="10" height="10" />
      </g>
      <g class="Pref Pref_07" id="7">
        <rect X="160" Y="60" width="20" height="10" />
      </g>
      <g class="Pref Pref_08" id="8">
        <rect X="170" Y="70" width="10" height="20" />
      </g>
      <g class="Pref Pref_09" id="9">
        <rect X="160" Y="70" width="10" height="10" />
      </g>
      <g class="Pref Pref_10" id="10">
        <rect X="150" Y="70" width="10" height="10" />
      </g>
      <g class="Pref Pref_11" id="11">
        <rect X="150" Y="80" width="20" height="10" />
      </g>
      <g class="Pref Pref_12" id="12">
        <rect X="170" Y="90" width="10" height="20" />
      </g>
      <g class="Pref Pref_13" id="13">
        <rect X="150" Y="90" width="20" height="10" />
      </g>
      <g class="Pref Pref_14" id="14">
        <rect X="150" Y="100" width="10" height="10" />
      </g>
      <g class="Pref Pref_15" id="15">
        <rect X="140" Y="60" width="20" height="10" />
      </g>
      <g class="Pref Pref_16" id="16">
        <rect X="120" Y="60" width="20" height="10" />
      </g>
      <g class="Pref Pref_17" id="17">
        <rect X="110" Y="50" width="10" height="20" />
      </g>
      <g class="Pref Pref_18" id="18">
        <rect X="110" Y="70" width="10" height="20" />
      </g>
      <g class="Pref Pref_19" id="19">
        <rect X="140" Y="80" width="10" height="20" />
      </g>
      <g class="Pref Pref_20" id="20">
        <polygon points="130,70 150,70 150,80 140,80 140,100 130,100 130,70" />
      </g>
      <g class="Pref Pref_21" id="21">
        <rect X="120" Y="70" width="10" height="30" />
      </g>
      <g class="Pref Pref_22" id="22">
        <rect X="130" Y="100" width="20" height="10" />
      </g>
      <g class="Pref Pref_23" id="23">
        <rect X="120" Y="100" width="10" height="10" />
      </g>
      <g class="Pref Pref_24" id="24">
        <rect X="110" Y="100" width="10" height="20" />
      </g>
      <g class="Pref Pref_25" id="25">
        <rect X="110" Y="90" width="10" height="10" />
      </g>
      <g class="Pref Pref_26" id="26">
        <polygon points="90,80 110,80 110,100 100,100 100,90 90,90 90,80" />
      </g>
      <g class="Pref Pref_27" id="27">
        <rect X="90" Y="90" width="10" height="20" />
      </g>
      <g class="Pref Pref_28" id="28">
        <rect X="80" Y="80" width="10" height="20" />
      </g>
      <g class="Pref Pref_29" id="29">
        <rect X="100" Y="100" width="10" height="10" />
      </g>
      <g class="Pref Pref_30" id="30">
        <rect X="90" Y="110" width="20" height="10" />
      </g>
      <g class="Pref Pref_31" id="31">
        <rect X="70" Y="80" width="10" height="10" />
      </g>
      <g class="Pref Pref_32" id="32">
        <rect X="60" Y="80" width="10" height="10" />
      </g>
      <g class="Pref Pref_33" id="33">
        <rect X="70" Y="90" width="10" height="10" />
      </g>
      <g class="Pref Pref_34" id="34">
        <rect X="60" Y="90" width="10" height="10" />
      </g>
      <g class="Pref Pref_35" id="35">
        <rect X="50" Y="80" width="10" height="20" />
      </g>
      <g class="Pref Pref_36" id="36">
        <rect X="70" Y="120" width="10" height="10" />
      </g>
      <g class="Pref Pref_37" id="37">
        <rect X="70" Y="110" width="10" height="10" />
      </g>
      <g class="Pref Pref_38" id="38">
        <rect X="60" Y="110" width="10" height="10" />
      </g>
      <g class="Pref Pref_39" id="39">
        <rect X="60" Y="120" width="10" height="10" />
      </g>
      <g class="Pref Pref_40" id="40">
        <rect X="20" Y="80" width="20" height="10" />
      </g>
      <g class="Pref Pref_41" id="41">
        <rect X="10" Y="80" width="10" height="10" />
      </g>
      <g class="Pref Pref_42" id="42">
        <rect X="0" Y="80" width="10" height="10" />
      </g>
      <g class="Pref Pref_43" id="43">
        <rect X="20" Y="90" width="10" height="20" />
      </g>
      <g class="Pref Pref_44" id="44">
        <rect X="30" Y="90" width="10" height="10" />
      </g>
      <g class="Pref Pref_45" id="45">
        <rect X="30" Y="100" width="10" height="10" />
      </g>
      <g class="Pref Pref_46" id="46">
        <rect X="20" Y="110" width="20" height="10" />
      </g>
      <g class="Pref Pref_47" id="47">
        <rect X="0" Y="130" width="10" height="10" />
      </g>
    </svg>

  </div>

    <script>
    var p_names = [
      '北海道','青森県','岩手県','宮城県','秋田県','山形県','福島県','茨城県','栃木県','群馬県',
      '埼玉県','千葉県','東京都','神奈川県','新潟県','富山県','石川県','福井県','山梨県','長野県',
      '岐阜県','静岡県','愛知県','三重県','滋賀県','京都府','大阪府','兵庫県','奈良県','和歌山県',
      '鳥取県','島根県','岡山県','広島県','山口県','徳島県','香川県','愛媛県','高知県','福岡県',
      '佐賀県','長崎県','熊本県','大分県','宮崎県','鹿児島県','沖縄県'];
    var p_counts = [];

      $('.Pref').css('cursor', 'pointer');

      for(var i = 1; i < 48; i++){
        $('.Pref_' + String(i).padStart(2, '0') + ' rect').css('fill', 'rgb(220, 220, 220)');
        $('.Pref_' + String(i).padStart(2, '0') + ' rect').css('stroke', 'white');
        $('.Pref_' + String(i).padStart(2, '0') + ' polygon').css('fill', 'rgb(220, 220, 220)');
        $('.Pref_' + String(i).padStart(2, '0') + ' polygon').css('stroke', 'white');
        p_counts[i-1] = 0;
      }
      var pref_stats = @json($pref_stats);
      if(pref_stats.length > 0) {
        var max_count = Math.log10(pref_stats[0].p_count);
        var coefficient = 220 / max_count;
        for(var i = 0; i < pref_stats.length; i++){
          var color = 221 - Math.floor(Math.log10(pref_stats[i].p_count) * coefficient);
          $('.Pref_' + String(pref_stats[i].pcode).padStart(2, '0') + ' rect').css('fill', 'rgb(' + color + ', ' + color + ', 220)');
          $('.Pref_' + String(pref_stats[i].pcode).padStart(2, '0') + ' polygon').css('fill', 'rgb(' + color + ', ' + color + ', 220)');
          p_counts[pref_stats[i].pcode-1] = pref_stats[i].p_count;
        }
      }

      $('.Pref').on('mouseenter', function(e) {
        var pcode = e.target.parentNode.id;
        $('#pref_msg').text(p_names[pcode-1] + ': ' + p_counts[pcode-1].toLocaleString() + '件');
      });
      $('.Pref').on('mouseleave', function(e) {
        $('#pref_msg').text('');
      });

    </script>
